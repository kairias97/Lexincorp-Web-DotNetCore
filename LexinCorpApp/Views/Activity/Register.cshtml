@model RegisterActivityViewModel
<script type="text/javascript">
    $(function ()
    {
        //Para setear idioma inicial
        //$("#Package_Description").prop("lang", $("#IsEnglish").value ? "en" : "es");
        $("div.container-fluid").css("background-color", "lightgrey");

        $("#clientFilter").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "/Client/Search",
                    type: "GET",
                    data: request,
                    dataType: "json",
                    dataFilter: function (data) { return data; },
                    success: function (data) {
                        console.log(data);
                        response($.map(data, function (item) {
                            return {
                                value: item.name,
                                label: item.name,
                                clientName: item.name,
                                clientId: item.id,
                                isEnglish: item.billingInEnglish,
                                feePerHour: item.feePerHour,
                                packages: item.packages
                            }
                        }))
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        var err = eval("(" + XMLHttpRequest.responseText + ")");
                        alert(err.Message)
                        // console.log("Ajax Error!");
                    }
                });
             },
            minLength: 1,
            select: function (event, ui) {
                //$("#Package_ClientId").val(ui.item.clientId);
                $("#ClientName").val(ui.item.clientName);
                $("#IsEnglish").prop('checked', ui.item.isEnglish);
                $("#IsClientSelected").prop('checked', true);
                $("#FeePerHour").val(ui.item.feePerHour);
                $("#clientLanguage").val(ui.item.isEnglish ? "Inglés" : "Español");
                //var list = ui.item.packages;
                var clientId = ui.item.id;
                $.ajax({
                    url: "/Package/Search?clientId=" + ui.item.clientId,
                    type: "GET",
                    data: clientId,
                    dataType: "json",
                    dataFilter: function (data) { return data; },
                    success: function (data) {
                        $("#Packages").empty().append("<option value=''>Seleccionar paquete</option>").val('null');
                        $.each(data, function (i, item) {
                            var options = "<option value='" + item.id + "'>" + item.name + "</option>";
                            $("#Packages").append(options);
                        });
                        console.log(data);
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        var err = eval("(" + XMLHttpRequest.responseText + ")");
                        alert(err.Message);
                    }
                });
                $("#clientLanguage").val(ui.item.isEnglish ? "Inglés" : "Español");
                //$("#Package_Description").prop("lang", ui.item.isEnglish ? "en" : "es");


            }

        });

    });
</script>

<div class="container-fluid" style="width:100%">
    <form>
        <input type="checkbox" hidden asp-for="@Model.IsEnglish" />
        <input type="checkbox" hidden asp-for="@Model.IsClientSelected" />
        <div class="row">
            <div class="offset-md-1 col-md-10">
                <div class="row bg-light rounded" style="margin-top:20px">
                    <div class="offset-1 col-md-10">
                        <div class="form-row" style="margin-top:20px">
                            <h4 class="text-center text-secondary">Paso 1</h4>
                        </div>
                        <div class="form-row" style="margin-top:20px">
                            <div class="form-group col-md-5">
                                <label for="activityDate">Fecha:*</label>
                                <input type="text" id="activityDate" class="form-control" placeholder="Fecha" aria-label="Fecha del registro" />
                            </div>
                            <div class="form-group col-md-5">
                                <label for="clientFilter">Búsqueda del cliente:*</label>
                                <input type="text" id="clientFilter" class="form-control" placeholder="Búsqueda del cliente" aria-label="Búsqueda del cliente" />
                            </div>
                        </div>
                        <div class="form-row" style="margin-top:20px">
                            <div class="form-group col-md-5">
                                <label for="ClientName">Nombre del cliente</label>
                                <input type="text" readonly asp-for="@Model.ClientName" class="form-control" aria-label="Nombre del cliente" />
                            </div>
                            <div class="form-group col-md-5">
                                <label for="clientName">Idioma de facturación:</label>
                                <input type="text" readonly id="clientLanguage" value="@(Model.IsClientSelected ? ((Model.IsEnglish) ? "Inglés" : "Español"): "")" class="form-control" aria-label="Idioma de facturación" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row bg-light rounded" style="margin-top:20px">
                    <div class="offset-1 col-md-10">
                        <div class="form-row" style="margin-top:20px">
                            <h4 class="text-center text-secondary">Paso 2</h4>
                        </div>
                        <div class="form-row" style="margin-top:20px">
                            <div class="form-group col-md-5">
                                <label for="Packages">Paquetes disponibles:</label>
                                <select class="form-control" id="Packages">
                                </select>
                            </div>
                            <div class="form-group col-md-5">
                                <label for="retainers">Retainers:</label>
                                <select id="retainers" class="form-control">
                                    @foreach (var r in Model.Retainers)
                                    {
                                        <option value="@r.Id">@r.SpanishName</option>
                                    }
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="items">Items:</label>
                                <select id="items" class="form-control">
                                    @foreach (var i in Model.Items)
                                    {
                                        <option value="@i.Id">@i.Name</option>
                                    }
                                </select>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="itemsPrice">Precio: </label>
                                <input type="number" class="form-control" id="itemsPrice" />
                            </div>
                            <div class="form-group col-md-4">
                                <label for="itemsQuantity">Cantidad:</label>
                                <input type="number" class="form-control" id="itemsQuantity"/>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-5">
                                <label for="hours">Horas:</label>
                                <input type="number" class="form-control" id="hours" />
                            </div>
                            <div class="form-group col-md-5">
                                <label for="FeePerHour">Precio por hora:</label>
                                <input type="text" asp-for="@Model.FeePerHour" class="form-control" id="FeePerHour" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row bg-light rounded" style="margin-top:20px">
                    <div class="offset-1 col-md-10">
                        <div class="form-row" style="margin-top:20px">
                            <h4 class="text-center text-secondary">Paso 3</h4>
                        </div>
                        <div class="form-row" style="margin-top:20px">
                            <div class="form-group col-md-5">
                                <label for="categories">Categoría:</label>
                                <select id="categories" class="form-control">
                                    @foreach (var c in Model.Categories)
                                    {
                                        <option value="@c.Id">@c.Name</option>
                                    }
                                </select>
                            </div>
                            <div class="form-group col-md-5">
                                <label for="services">Servicios:</label>
                                <select id="services" class="form-control">
                                    @foreach (var s in Model.Services)
                                    {
                                        <option value="@s.Id">@s.Name</option>
                                    }
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-10">
                                <label for="description">Descripción:</label>
                                <input type="text" class="form-control" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row bg-light rounded" style="margin-top:20px;margin-bottom:20px;">
                    <div class="offset-1 col-md-10">
                        <div class="form-row" style="margin-top:20px">
                            <h4 class="text-center text-secondary">Paso 4</h4>
                        </div>
                        <div class="form-row" style="margin-top:20px">
                            <div class="form-group col-md-5">
                                <label for="expenses">Gastos:</label>
                                <select id="expenses" class="form-control">
                                    @foreach (var e in Model.Expenses)
                                    {
                                        <option value="@e.Id">@e.Name</option>
                                    }
                                </select>
                            </div>
                            <div class="form-group col-md-5">
                                <label for="expensesQuantity">Cantidad:</label>
                                <input type="number" class="form-control" />
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-5">
                                <label for="expensesPrice">Monto:</label>
                                <input type="number" class="form-control" />
                            </div>
                            <div class="form-group col-md-5 offset-md-1">
                                <button class="btn btn-primary" style="margin-top:30px">Agregar</button>
                            </div>
                        </div>
                        <div class="form-row table-responsive" style="margin-bottom:20px">
                            <table class="table table-stribed table-bordered">
                                <thead>
                                    <tr>
                                        <th>Gasto</th>
                                        <th>Cantidad</th>
                                        <th>Monto</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Es comida</td>
                                        <td>Para tu</td>
                                        <td>Animalito</td>
                                    </tr>
                                    <tr>
                                        <td colspan="3">Cyyyyyyyy</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
